name: helpers.report-dora-metric.yml
on:
  workflow_call:
    inputs:
      status:
        description: "The status of the pipeline"
        required: true
        type: string

jobs:
  submit-dora-metrics:
    name: Submitt DORA Metrics
    environment: 'Service'
    runs-on: ubuntu-latest
    steps:
      - name: Authenticate with AWS
        uses: aws-actions/configure-aws-credentials@v4
        with:
          aws-region: ${{ vars.AWS_REGION }}
          role-to-assume: arn:aws:iam::${{ vars.AWS_ACCOUNT_ID }}:role/${{ vars.AWS_DEPLOYMENT_ROLE_NAME }}
      - name: Submit metric
        uses: nsbno/platform-actions/.github/actions/helpers/dora-metrics@dora-metrics
        with:
          status: ${{ inputs.status }}
          topic_arn: ${{ vars.DORA_METRICS_SNS_TOPIC_ARN }}